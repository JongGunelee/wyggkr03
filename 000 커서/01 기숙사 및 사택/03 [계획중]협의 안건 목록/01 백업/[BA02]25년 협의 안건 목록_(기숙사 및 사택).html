<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>í˜‘ì˜ ë‚´ìš© ì‘ì„± ì‹œíŠ¸</title>
  <style>
    html, body {
      font-size: 18px;
      font-family: 'ë§‘ì€ ê³ ë”•', sans-serif;
      margin: 0;
      padding: 0;
    }
    body.fullscreen-mode #controls {
      display: none;
    }
    h2 {
      margin: 10px 20px;
      cursor: text;
      font-size: 24px;
      padding-left: 0;
    }
    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
      padding: 10px;
      background: #eef8ff;
      font-size: 14px;
    }
    .group {
      background: #eaf4ff;
      padding: 6px;
      border-radius: 6px;
      margin-right: 6px;
      min-width: 120px;
    }
    .group-title {
      font-size: 12px;
      font-weight: bold;
      margin-bottom: 3px;
      color: #2c5282;
    }
    button, input[type="text"] {
      padding: 4px 8px;
      font-size: 12px;
      cursor: pointer;
      border: 1px solid #999;
      background: #f2f2f2;
      border-radius: 4px;
      margin: 2px;
    }
    .group:nth-child(1) { background: #f0e6ff; } /* í•˜ì´í¼ë§í¬ */
    .group:nth-child(2) { background: #e6ffe6; } /* í–‰/ì—´ ì¡°ì‘ */
    .group:nth-child(3) { background: #ffe6e6; } /* ë³‘í•© */
    .group:nth-child(4) { background: #e6e6ff; } /* ì •ë ¬ */
    .group:nth-child(5) { background: #fff2e6; } /* íŒŒì¼ */
    .group:nth-child(6) { background: #e6ffff; } /* ìŠ¤íƒ€ì¼ - ì²­ë¡ìƒ‰ ê³„ì—´ */
    .group:nth-child(7) { background: #fff0f5; } /* ìˆ«ì ì…ë ¥ - ì—°í•œ ë¶„í™ìƒ‰ ê³„ì—´ */
    table {
      border-collapse: collapse;
      width: 100%;
      table-layout: auto;
      font-size: 18px;
    }
    th, td {
      border: 1px solid #aaa;
      padding: 10px;
      text-align: center;
      vertical-align: middle;
      resize: both;
      overflow: hidden;
      white-space: pre-wrap;
    }
    th {
      background: #dceeff;
      font-weight: bold;
    }
    th:first-child, td:first-child {
      width: 1%;
      white-space: nowrap;
    }
    td[contenteditable], th[contenteditable] {
      cursor: text;
    }
    .selected {
      outline: 2px solid #4a90e2;
    }
    .fullscreen-mode {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: #fff;
      z-index: 9999;
      padding: 20px 0;
      overflow: auto;
    }
    .fullscreen-mode #editableTable {
      max-width: 100%;
      margin: 0;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    #editableTable {
      margin-left: 20px;
      margin-right: 20px;
    }
    .style-panel {
      position: fixed;
      bottom: 10px;
      right: 10px;
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      padding: 15px;
      display: none;
      z-index: 1000;
      cursor: move;
      user-select: none;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      min-width: 200px;
    }
    .style-panel .title {
      margin: -15px -15px 15px -15px;
      padding: 10px 15px;
      font-weight: bold;
      cursor: move;
      background: #e9ecef;
      border-radius: 8px 8px 0 0;
      border-bottom: 1px solid #dee2e6;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .style-panel .title::before {
      content: "ğŸ¨";
      margin-right: 8px;
    }
    .style-panel .style-group {
      margin-bottom: 12px;
      padding-bottom: 12px;
      border-bottom: 1px solid #dee2e6;
    }
    .style-panel .style-group:last-child {
      border-bottom: none;
      margin-bottom: 0;
      padding-bottom: 0;
    }
    .style-panel label {
      font-size: 13px;
      color: #495057;
      display: block;
      margin-bottom: 8px;
    }
    .style-panel input[type="number"] {
      width: 60px;
      padding: 4px 8px;
      border: 1px solid #ced4da;
      border-radius: 4px;
      margin-right: 5px;
    }
    .style-panel input[type="color"] {
      width: 40px;
      height: 24px;
      padding: 0;
      border: 1px solid #ced4da;
      border-radius: 4px;
      cursor: pointer;
    }
    .style-panel input[type="checkbox"] {
      margin-right: 5px;
      vertical-align: middle;
    }
    .style-panel .preset-sizes {
      display: flex;
      gap: 5px;
      margin-top: 5px;
    }
    .style-panel .preset-sizes button {
      padding: 2px 8px;
      font-size: 12px;
      background: #e9ecef;
      border: 1px solid #ced4da;
      border-radius: 4px;
      cursor: pointer;
    }
    .style-panel .preset-sizes button:hover {
      background: #dee2e6;
    }
    .style-panel .preset-colors {
      display: flex;
      gap: 5px;
      margin-top: 5px;
    }
    .style-panel .preset-colors button {
      width: 20px;
      height: 20px;
      padding: 0;
      border: 1px solid #ced4da;
      border-radius: 4px;
      cursor: pointer;
    }
    tbody tr:nth-child(even) {
      background-color: rgba(220, 220, 220, 0.2);
    }
    .tooltip {
      position: absolute;
      background: #333;
      color: white;
      padding: 5px 10px;
      border-radius: 4px;
      font-size: 14px;
      display: none;
      z-index: 1000;
      white-space: nowrap;
    }
    .group:hover .tooltip {
      display: block;
    }
    .align-panel {
      position: fixed;
      top: 100px;
      right: 20px;
      background: #f0f0f0;
      border: 1px solid #aaa;
      padding: 20px;
      border-radius: 8px;
      display: none;
      z-index: 1000;
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
      cursor: move;
      user-select: none;
    }
    .align-panel .title {
      margin-bottom: 10px;
      font-weight: bold;
      cursor: move;
      padding: 5px;
      background: #e0e0e0;
      border-radius: 4px;
    }
    .align-panel button {
      margin: 5px;
      min-width: 80px;
    }
    .edit-mode-button {
      position: fixed;
      top: 5px;
      left: 10px;
      padding: 4px 8px;
      background: #4a90e2;
      color: white;
      border: none;
      border-radius: 3px;
      cursor: pointer;
      font-size: 10px;
      z-index: 10000;
      display: none;
      transform: scale(0.85);
    }
    .fullscreen-mode .edit-mode-button {
      display: block;
    }
    .fullscreen-mode h2 {
      margin: 10px 20px;
      padding-left: 0;
    }
    .mode-message {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 10px 20px;
      border-radius: 5px;
      z-index: 10001;
      font-size: 14px;
      text-align: center;
      display: none;
    }
    .number-panel {
      position: fixed;
      bottom: 10px;
      right: 10px;
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      padding: 15px;
      display: none;
      z-index: 1000;
      cursor: move;
      user-select: none;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      min-width: 250px;
    }
    .number-panel .title {
      margin: -15px -15px 15px -15px;
      padding: 10px 15px;
      font-weight: bold;
      cursor: move;
      background: #e9ecef;
      border-radius: 8px 8px 0 0;
      border-bottom: 1px solid #dee2e6;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .number-panel .title::before {
      content: "ğŸ”¢";
      margin-right: 8px;
    }
    .number-panel .number-group {
      margin-bottom: 12px;
      padding-bottom: 12px;
      border-bottom: 1px solid #dee2e6;
    }
    .number-panel .number-group:last-child {
      border-bottom: none;
      margin-bottom: 0;
      padding-bottom: 0;
    }
    .number-panel label {
      font-size: 13px;
      color: #495057;
      display: block;
      margin-bottom: 8px;
    }
    .number-panel select, .number-panel input {
      width: 100%;
      padding: 4px 8px;
      border: 1px solid #ced4da;
      border-radius: 4px;
      margin-bottom: 8px;
    }
    .number-panel .preset-buttons {
      display: flex;
      gap: 5px;
      margin-top: 5px;
      flex-wrap: wrap;
    }
    .number-panel .preset-buttons button {
      padding: 2px 8px;
      font-size: 12px;
      background: #e9ecef;
      border: 1px solid #ced4da;
      border-radius: 4px;
      cursor: pointer;
    }
    .number-panel .preset-buttons button:hover {
      background: #dee2e6;
    }
    .number-panel .unit-group {
      display: flex;
      gap: 10px;
    }
    .number-panel .unit-group input {
      flex: 1;
    }
    .number-panel .multi-input {
      margin-top: 10px;
      padding: 10px;
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      border-radius: 4px;
      display: none;
    }
    .number-panel .multi-input.active {
      display: block;
    }
    .number-panel .cell-input {
      display: flex;
      align-items: center;
      margin-bottom: 5px;
      padding: 5px;
      background: #fff;
      border: 1px solid #dee2e6;
      border-radius: 4px;
    }
    .number-panel .cell-input label {
      margin: 0;
      margin-right: 10px;
      min-width: 60px;
    }
    .number-panel .cell-input input {
      flex: 1;
      margin: 0;
    }
    .number-panel .quick-input {
      display: flex;
      gap: 5px;
      margin-top: 10px;
    }
    .number-panel .quick-input button {
      flex: 1;
      padding: 5px;
      font-size: 12px;
    }
  </style>
</head>
<body>

<div id="controls" class="controls">
  <div class="group">
    <div class="group-title">í•˜ì´í¼ë§í¬</div>
    <input type="text" id="searchInput" placeholder="ê²€ìƒ‰ì–´(ì •ê·œì‹)">
    <input type="text" id="linkInput" placeholder="URL">
    <button onclick="applyHyperlinks()">ì ìš©</button>
    <button onclick="clearHyperlinks()">ì´ˆê¸°í™”</button>
    <div class="tooltip">ê²€ìƒ‰ì–´ì™€ URLì„ ì…ë ¥í•˜ì—¬ ì„ íƒí•œ í…ìŠ¤íŠ¸ì— í•˜ì´í¼ë§í¬ë¥¼ ì ìš©í•©ë‹ˆë‹¤.</div>
  </div>
  <div class="group">
    <div class="group-title">í–‰/ì—´ ì¡°ì‘</div>
    <button onclick="addRow()">ì…ë ¥ í–‰ ì¶”ê°€</button>
    <button onclick="deleteRow()">ì…ë ¥ í–‰ ì‚­ì œ</button>
    <button onclick="addHeader()">ì œëª© ì¶”ê°€</button>
    <button onclick="deleteHeader()">ì œëª© ì‚­ì œ</button>
    <button onclick="addColumn()">ì—´ ì¶”ê°€</button>
    <button onclick="deleteColumn()">ì—´ ì‚­ì œ</button>
    <div class="tooltip">í…Œì´ë¸”ì˜ í–‰ê³¼ ì—´ì„ ì¶”ê°€í•˜ê±°ë‚˜ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
  </div>
  <div class="group">
    <div class="group-title">ë³‘í•©</div>
    <button onclick="toggleMergeMode()">ë³‘í•© ëª¨ë“œ</button>
    <button onclick="mergeCells()">ë³‘í•©</button>
    <button onclick="cancelMergeMode()">ì·¨ì†Œ</button>
    <button onclick="undoMerge()">ë˜ëŒë¦¬ê¸°</button>
    <div class="tooltip">ì…€ì„ ì„ íƒí•˜ì—¬ ë³‘í•©í•˜ê±°ë‚˜ ë³‘í•©ì„ ì·¨ì†Œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ë˜ëŒë¦¬ê¸° ìµœëŒ€ 10íšŒ ê°€ëŠ¥)</div>
  </div>
  <div class="group">
    <div class="group-title">ì •ë ¬</div>
    <button onclick="toggleAlignMode()">ì •ë ¬ ëª¨ë“œ</button>
    <button onclick="applyAlignment()">ì ìš©</button>
    <button onclick="cancelAlignMode()">ì·¨ì†Œ</button>
    <div class="tooltip">ì…€ì„ ì„ íƒí•˜ì—¬ ì •ë ¬ ë°©ì‹ì„ ì ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
  </div>
  <div class="group">
    <div class="group-title">íŒŒì¼</div>
    <button onclick="downloadHTML()">HTML ë‹¤ìš´ë¡œë“œ</button>
    <button onclick="toggleFullscreen()">ì „ì²´í™”ë©´</button>
    <div class="tooltip">HTML íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•˜ê±°ë‚˜ ì „ì²´í™”ë©´ ëª¨ë“œë¥¼ ì „í™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
  </div>
  <div class="group">
    <div class="group-title">ìŠ¤íƒ€ì¼</div>
    <button onclick="toggleStyleMode()">ìŠ¤íƒ€ì¼ ëª¨ë“œ</button>
    <button onclick="applyStyle()">ì ìš©</button>
    <button onclick="cancelStyleMode()">ì·¨ì†Œ</button>
    <div class="tooltip">ì…€ì„ ì„ íƒí•˜ì—¬ ê¸€ì í¬ê¸°, êµµê¸°, ìƒ‰ìƒì„ í•œ ë²ˆì— ì ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
  </div>
  <div class="group">
    <div class="group-title">ìˆ«ì ì…ë ¥</div>
    <button onclick="toggleNumberMode()">ìˆ«ì ì…ë ¥ ëª¨ë“œ</button>
    <button onclick="applyNumberFormat()">ì ìš©</button>
    <button onclick="cancelNumberMode()">ì·¨ì†Œ</button>
    <div class="tooltip">ì…€ì„ ì„ íƒí•˜ì—¬ ìˆ«ì í˜•ì‹ê³¼ ë‹¨ìœ„ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
  </div>
</div>

<h2 contenteditable="true">í˜‘ì˜ ì•ˆê±´ ëª©ë¡</h2>

<table id="editableTable">
  <thead>
    <tr>
      <th>NO.</th>
      <th contenteditable="true">í•­ëª©</th>
      <th contenteditable="true">ì—°ê´€ì„±</th>
      <th contenteditable="true">ì˜ˆì‚°</th>
      <th contenteditable="true">ê³„íš</th>
      <th contenteditable="true">ë¹„ìš©(ì˜ˆìƒ)</th>
      <th contenteditable="true">ì§„í–‰</th>
      <th contenteditable="true">ì´ì›”</th>
      <th contenteditable="true">ë¹„ê³ </th>
    </tr>
  </thead>
  <tbody id="tbody"></tbody>
</table>

<div class="style-panel" id="stylePanel">
  <div class="title">ìŠ¤íƒ€ì¼ ì„¤ì •</div>
  <div class="style-group">
    <label>ê¸€ì í¬ê¸°</label>
    <input type="number" id="fontSize" min="10" max="40" value="18"> px
    <div class="preset-sizes">
      <button onclick="setFontSize(14)">ì‘ê²Œ</button>
      <button onclick="setFontSize(18)">ë³´í†µ</button>
      <button onclick="setFontSize(24)">í¬ê²Œ</button>
      <button onclick="setFontSize(32)">ë§¤ìš° í¬ê²Œ</button>
    </div>
  </div>
  <div class="style-group">
    <label>ê¸€ì êµµê¸°</label>
    <input type="checkbox" id="fontBold"> êµµê²Œ
  </div>
  <div class="style-group">
    <label>ê¸€ì ìƒ‰ìƒ</label>
    <input type="color" id="fontColor">
    <div class="preset-colors">
      <button style="background: #000000" onclick="setFontColor('#000000')"></button>
      <button style="background: #ff0000" onclick="setFontColor('#ff0000')"></button>
      <button style="background: #0000ff" onclick="setFontColor('#0000ff')"></button>
      <button style="background: #008000" onclick="setFontColor('#008000')"></button>
    </div>
  </div>
</div>

<div class="align-panel" id="alignPanel">
  <div class="title">ì •ë ¬ ë°©í–¥ ì„ íƒ</div>
  <button onclick="applyAlignment('left')">ì¢Œì¸¡ ì •ë ¬</button>
  <button onclick="applyAlignment('center')">ì¤‘ì•™ ì •ë ¬</button>
  <button onclick="applyAlignment('right')">ìš°ì¸¡ ì •ë ¬</button>
  <button onclick="cancelAlignMode()" style="margin-top: 10px;">ì·¨ì†Œ</button>
</div>

<div class="edit-mode-button" onclick="toggleFullscreen()">í¸ì§‘ ëª¨ë“œë¡œ ì „í™˜</div>
<div id="modeMessage" class="mode-message"></div>

<div class="number-panel" id="numberPanel">
  <div class="title">ìˆ«ì ì…ë ¥ ì„¤ì •</div>
  <div class="number-group">
    <label>ì…ë ¥ í˜•ì‹</label>
    <select id="numberFormat">
      <option value="number">ì¼ë°˜ ìˆ«ì</option>
      <option value="thousand">ì²œ ë‹¨ìœ„ êµ¬ë¶„</option>
      <option value="currency">í†µí™” í˜•ì‹</option>
      <option value="percent">ë°±ë¶„ìœ¨</option>
      <option value="decimal">ì†Œìˆ˜ì </option>
    </select>
  </div>
  <div class="number-group">
    <label>ë‹¨ìœ„ ë³€í™˜</label>
    <select id="unitType">
      <option value="none">ë‹¨ìœ„ ì—†ìŒ</option>
      <option value="accounting">íšŒê³„ ë‹¨ìœ„</option>
      <option value="currency">ê¸ˆì•¡ ë‹¨ìœ„</option>
      <option value="custom">ì‚¬ìš©ì ì •ì˜</option>
    </select>
    <div class="unit-group">
      <input type="text" id="unitPrefix" placeholder="ì ‘ë‘ì–´">
      <input type="text" id="unitSuffix" placeholder="ì ‘ë¯¸ì–´">
    </div>
  </div>
  <div class="number-group">
    <label>ë²”ìœ„ ì„¤ì •</label>
    <div class="unit-group">
      <input type="number" id="minValue" placeholder="ìµœì†Œê°’">
      <input type="number" id="maxValue" placeholder="ìµœëŒ€ê°’">
    </div>
  </div>
  <div class="number-group">
    <label>ìì£¼ ì‚¬ìš©í•˜ëŠ” ë‹¨ìœ„</label>
    <div class="preset-buttons">
      <button onclick="setUnit('ì›')">ì›</button>
      <button onclick="setUnit('ì²œì›')">ì²œì›</button>
      <button onclick="setUnit('ë§Œì›')">ë§Œì›</button>
      <button onclick="setUnit('ë°±ë§Œì›')">ë°±ë§Œì›</button>
      <button onclick="setUnit('ì–µì›')">ì–µì›</button>
      <button onclick="setUnit('ê°œ')">ê°œ</button>
      <button onclick="setUnit('SET')">SET</button>
      <button onclick="setUnit('BOX')">BOX</button>
    </div>
  </div>
  <div class="number-group">
    <label>ë‹¤ì¤‘ ì…€ ì…ë ¥</label>
    <div class="multi-input" id="multiInput">
      <div id="cellInputs"></div>
      <div class="quick-input">
        <button onclick="applySameValue()">ëª¨ë‘ ê°™ì€ ê°’</button>
        <button onclick="applySequence()">ìˆœì°¨ ì¦ê°€</button>
        <button onclick="applyRandom()">ëœë¤ ê°’</button>
      </div>
    </div>
  </div>
</div>

<script>
let undoStack = [];
let mergeMode = false;
let isSelecting = false;
let selectedCell = null;
let alignMode = false;
let styleMode = false;
let numberMode = false;

function saveState() {
  undoStack.push(document.getElementById('editableTable').innerHTML);
  if (undoStack.length > 10) undoStack.shift();
}

function undoMerge() {
  if (!undoStack.length) return alert('ë˜ëŒë¦´ ì‘ì—…ì´ ì—†ìŠµë‹ˆë‹¤.');
  document.getElementById('editableTable').innerHTML = undoStack.pop();
  initSelectable();
}

function addRow() {
  saveState();
  const tbody = document.getElementById('tbody');
  const rowCount = tbody.rows.length + 1;
  const tr = document.createElement('tr');
  tr.innerHTML = `<td>${rowCount}</td>` + '<td contenteditable="true"></td>'.repeat(8);
  tbody.appendChild(tr);
  initSelectable();
}

function deleteRow() {
  saveState();
  const tbody = document.getElementById('tbody');
  if (tbody.rows.length > 1) tbody.deleteRow(-1);
}

function addHeader() {
  saveState();
  const tr = document.createElement('tr');
  for (let i = 0; i < 9; i++) {
    const th = document.createElement('th');
    th.contentEditable = 'true';
    th.style.background = '#dceeff';
    tr.appendChild(th);
  }
  document.querySelector('#editableTable thead').appendChild(tr);
}

function deleteHeader() {
  saveState();
  const thead = document.querySelector('#editableTable thead');
  if (thead.rows.length > 1) thead.deleteRow(-1);
}

function addColumn() {
  saveState();
  document.querySelectorAll('#editableTable tr').forEach(row => {
    const cell = row.insertCell(-1);
    cell.contentEditable = 'true';
    if (row.parentElement.tagName === 'THEAD') {
      cell.style.background = '#dceeff';
    }
  });
  initSelectable();
}

function deleteColumn() {
  saveState();
  document.querySelectorAll('#editableTable tr').forEach(row => {
    if (row.cells.length > 1) row.deleteCell(-1);
  });
  initSelectable();
}

function showModeMessage(message) {
  const messageBox = document.getElementById('modeMessage');
  messageBox.textContent = message;
  messageBox.style.display = 'block';
  setTimeout(() => {
    messageBox.style.display = 'none';
  }, 3000);
}

function toggleMergeMode() {
  mergeMode = true;
  alignMode = false;
  styleMode = false;
  clearSelection();
  document.getElementById('alignPanel').style.display = 'none';
  document.getElementById('stylePanel').style.display = 'none';
  showModeMessage('ë³‘í•© ëª¨ë“œ í™œì„±í™”\nì·¨ì†Œ ë²„íŠ¼ì„ ëˆ„ë¥¼ ë•Œê¹Œì§€ ê³„ì†í•´ì„œ ì…€ì„ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
}

function cancelMergeMode() {
  mergeMode = false;
  clearSelection();
}

function mergeCells() {
  if (!mergeMode) return alert('ë³‘í•© ëª¨ë“œë¥¼ í™œì„±í™”í•˜ì„¸ìš”.');
  const selected = Array.from(document.querySelectorAll('.selected'));
  if (selected.length < 2) return alert('ë³‘í•©í•  ì…€ì„ ì„ íƒí•˜ì„¸ìš”.');
  saveState();
  const table = document.getElementById('editableTable');
  const rows = selected.map(c => c.parentElement.rowIndex);
  const cols = selected.map(c => c.cellIndex);
  const r1 = Math.min(...rows), r2 = Math.max(...rows);
  const c1 = Math.min(...cols), c2 = Math.max(...cols);
  const master = table.rows[r1].cells[c1];
  let combined = master.innerHTML;
  for (let i = r1; i <= r2; i++) {
    for (let j = c1; j <= c2; j++) {
      if (i === r1 && j === c1) continue;
      combined += '<br>' + table.rows[i].cells[j]?.innerHTML;
    }
  }
  master.innerHTML = combined;
  master.rowSpan = r2 - r1 + 1;
  master.colSpan = c2 - c1 + 1;
  for (let i = r2; i >= r1; i--) {
    for (let j = c2; j >= c1; j--) {
      if (i === r1 && j === c1) continue;
      table.rows[i].deleteCell(j);
    }
  }
  mergeMode = false;
  clearSelection();
}

function toggleAlignMode() {
  alignMode = true;
  mergeMode = false;
  styleMode = false;
  clearSelection();
  const alignPanel = document.getElementById('alignPanel');
  alignPanel.style.display = 'block';
  document.getElementById('stylePanel').style.display = 'none';
  showModeMessage('ì •ë ¬ ëª¨ë“œ í™œì„±í™”\nì·¨ì†Œ ë²„íŠ¼ì„ ëˆ„ë¥¼ ë•Œê¹Œì§€ ê³„ì†í•´ì„œ ì…€ì„ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
  
  // ë“œë˜ê·¸ ê¸°ëŠ¥ ì´ˆê¸°í™”
  initAlignPanelDrag();
}

function initAlignPanelDrag() {
  const alignPanel = document.getElementById('alignPanel');
  const title = alignPanel.querySelector('.title');
  let isDragging = false;
  let currentX;
  let currentY;
  let initialX;
  let initialY;
  let xOffset = 0;
  let yOffset = 0;

  title.addEventListener('mousedown', dragStart);
  document.addEventListener('mousemove', drag);
  document.addEventListener('mouseup', dragEnd);

  function dragStart(e) {
    initialX = e.clientX - xOffset;
    initialY = e.clientY - yOffset;

    if (e.target === title) {
      isDragging = true;
    }
  }

  function drag(e) {
    if (isDragging) {
      e.preventDefault();
      currentX = e.clientX - initialX;
      currentY = e.clientY - initialY;

      xOffset = currentX;
      yOffset = currentY;

      setTranslate(currentX, currentY, alignPanel);
    }
  }

  function dragEnd(e) {
    initialX = currentX;
    initialY = currentY;
    isDragging = false;
  }

  function setTranslate(xPos, yPos, el) {
    el.style.transform = `translate(${xPos}px, ${yPos}px)`;
  }
}

function cancelAlignMode() {
  alignMode = false;
  clearSelection();
  const alignPanel = document.getElementById('alignPanel');
  alignPanel.style.display = 'none';
  alignPanel.style.transform = 'translate(0, 0)';
}

function applyAlignment(align) {
  if (!alignMode) return;
  const selected = Array.from(document.querySelectorAll('.selected'));
  if (selected.length === 0) {
    alert('ì •ë ¬í•  ì…€ì„ ì„ íƒí•˜ì„¸ìš”.');
    return;
  }
  
  selected.forEach(cell => cell.style.textAlign = align);
  alignMode = false;
  clearSelection();
  document.getElementById('alignPanel').style.display = 'none';
}

function toggleStyleMode() {
  styleMode = true;
  mergeMode = false;
  alignMode = false;
  clearSelection();
  const stylePanel = document.getElementById('stylePanel');
  stylePanel.style.display = 'block';
  document.getElementById('alignPanel').style.display = 'none';
  showModeMessage('ìŠ¤íƒ€ì¼ ëª¨ë“œ í™œì„±í™”\nì·¨ì†Œ ë²„íŠ¼ì„ ëˆ„ë¥¼ ë•Œê¹Œì§€ ê³„ì†í•´ì„œ ì…€ì„ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
  
  // ë“œë˜ê·¸ ê¸°ëŠ¥ ì´ˆê¸°í™”
  initStylePanelDrag();
}

function initStylePanelDrag() {
  const stylePanel = document.getElementById('stylePanel');
  const title = stylePanel.querySelector('.title');
  let isDragging = false;
  let currentX;
  let currentY;
  let initialX;
  let initialY;
  let xOffset = 0;
  let yOffset = 0;

  title.addEventListener('mousedown', dragStart);
  document.addEventListener('mousemove', drag);
  document.addEventListener('mouseup', dragEnd);

  function dragStart(e) {
    initialX = e.clientX - xOffset;
    initialY = e.clientY - yOffset;

    if (e.target === title) {
      isDragging = true;
    }
  }

  function drag(e) {
    if (isDragging) {
      e.preventDefault();
      currentX = e.clientX - initialX;
      currentY = e.clientY - initialY;

      xOffset = currentX;
      yOffset = currentY;

      setTranslate(currentX, currentY, stylePanel);
    }
  }

  function dragEnd(e) {
    initialX = currentX;
    initialY = currentY;
    isDragging = false;
  }

  function setTranslate(xPos, yPos, el) {
    el.style.transform = `translate(${xPos}px, ${yPos}px)`;
  }
}

function cancelStyleMode() {
  styleMode = false;
  clearSelection();
  const stylePanel = document.getElementById('stylePanel');
  stylePanel.style.display = 'none';
  stylePanel.style.transform = 'translate(0, 0)';
}

function applyStyle() {
  if (!styleMode) return alert('ìŠ¤íƒ€ì¼ ëª¨ë“œë¥¼ í™œì„±í™”í•˜ì„¸ìš”.');
  const selected = Array.from(document.querySelectorAll('.selected'));
  if (selected.length === 0) return alert('ìŠ¤íƒ€ì¼ì„ ì ìš©í•  ì…€ì„ ì„ íƒí•˜ì„¸ìš”.');
  
  const fontSize = document.getElementById('fontSize').value;
  const isBold = document.getElementById('fontBold').checked;
  const fontColor = document.getElementById('fontColor').value;
  
  selected.forEach(cell => {
    cell.style.fontSize = fontSize + 'px';
    cell.style.fontWeight = isBold ? 'bold' : 'normal';
    cell.style.color = fontColor;
  });
  
  styleMode = false;
  clearSelection();
  document.getElementById('stylePanel').style.display = 'none';
}

function initSelectable() {
  clearSelection();
  document.querySelectorAll('#editableTable td, #editableTable th').forEach(cell => {
    cell.onmousedown = e => {
      if (!mergeMode && !alignMode && !styleMode && !numberMode) return;
      e.preventDefault();
      if (!isSelecting) {
        saveState();
        isSelecting = true;
      }
      cell.classList.add('selected');
      if (numberMode) {
        updateMultiInput();
      }
    };
    cell.onmouseover = e => {
      if ((mergeMode || alignMode || styleMode || numberMode) && isSelecting) {
        e.target.classList.add('selected');
        if (numberMode) {
          updateMultiInput();
        }
      }
    };
    cell.onmouseup = () => {
      isSelecting = false;
    };
  });
  document.body.onmouseup = () => (isSelecting = false);
}

function clearSelection() {
  document.querySelectorAll('.selected').forEach(cell => cell.classList.remove('selected'));
}

function applyHyperlinks() {
  const pattern = document.getElementById('searchInput').value;
  const url = document.getElementById('linkInput').value;
  if (!pattern || !url) return alert('ê²€ìƒ‰ì–´ì™€ URL ëª¨ë‘ ì…ë ¥í•˜ì„¸ìš”.');
  let regex;
  try {
    regex = new RegExp(pattern, 'g');
  } catch {
    alert('ìœ íš¨í•˜ì§€ ì•Šì€ ì •ê·œì‹ì…ë‹ˆë‹¤.');
    return;
  }
  document.querySelectorAll('#editableTable tbody td').forEach(td => {
    td.innerHTML = td.innerHTML.replace(regex, match => `<a href="${url}" target="_blank" contenteditable="false">${match}</a>`);
  });
}

function clearHyperlinks() {
  document.querySelectorAll('#editableTable tbody td a').forEach(a => {
    const text = a.textContent;
    a.replaceWith(text);
  });
}

async function downloadHTML() {
  try {
    // ì‹¤ì œ ì…ë ¥ëœ í–‰ë§Œ í•„í„°ë§
    const tbody = document.getElementById('tbody');
    const rows = Array.from(tbody.rows);
    const nonEmptyRows = rows.filter(row => {
      // ì²« ë²ˆì§¸ ì…€(NO.)ì„ ì œì™¸í•œ ëª¨ë“  ì…€ì„ í™•ì¸
      return Array.from(row.cells).slice(1).some(cell => cell.textContent.trim() !== '');
    });

    // í…Œì´ë¸” ë³µì œ ë° ë¹ˆ í–‰ ì œê±°
    const tableClone = document.getElementById('editableTable').cloneNode(true);
    const tbodyClone = tableClone.querySelector('tbody');
    tbodyClone.innerHTML = ''; // ê¸°ì¡´ í–‰ ëª¨ë‘ ì œê±°
    
    // ì‹¤ì œ ì…ë ¥ëœ í–‰ë§Œ ì¶”ê°€
    nonEmptyRows.forEach(row => {
      tbodyClone.appendChild(row.cloneNode(true));
    });

    // í–‰ ë²ˆí˜¸ ì¬ì •ë ¬
    Array.from(tbodyClone.rows).forEach((row, index) => {
      row.cells[0].textContent = (index + 1).toString();
    });

    // HTML ìƒì„±
    const html = '<!DOCTYPE html>' + document.documentElement.outerHTML;
    const tempDiv = document.createElement('div');
    tempDiv.innerHTML = html;
    
    // ì›ë³¸ í…Œì´ë¸”ì„ ìˆ˜ì •ëœ í…Œì´ë¸”ë¡œ êµì²´
    const originalTable = tempDiv.querySelector('#editableTable');
    originalTable.parentNode.replaceChild(tableClone, originalTable);
    
    const finalHtml = '<!DOCTYPE html>' + tempDiv.innerHTML;
    const blob = new Blob(['ï»¿' + finalHtml], { type: 'text/html' });
    
    // í˜„ì¬ ë‚ ì§œë¥¼ YYMMDD í˜•ì‹ìœ¼ë¡œ ê°€ì ¸ì˜¤ê¸°
    const now = new Date();
    const year = now.getFullYear().toString().slice(-2);
    const month = (now.getMonth() + 1).toString().padStart(2, '0');
    const day = now.getDate().toString().padStart(2, '0');
    const dateStr = `${year}${month}${day}`;
    
    // íŒŒì¼ëª… ìƒì„±
    const defaultFileName = `í˜‘ì˜_ì•ˆê±´_ëª©ë¡_${dateStr}.html`;

    // íŒŒì¼ ì €ì¥ ë‹¤ì´ì–¼ë¡œê·¸ í‘œì‹œ
    const handle = await window.showSaveFilePicker({
      suggestedName: defaultFileName,
      types: [{
        description: 'HTML íŒŒì¼',
        accept: {'text/html': ['.html']},
      }],
    });

    // íŒŒì¼ ì €ì¥
    const writable = await handle.createWritable();
    await writable.write(blob);
    await writable.close();

    alert('íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
  } catch (err) {
    if (err.name !== 'AbortError') {
      console.error('íŒŒì¼ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:', err);
      alert('íŒŒì¼ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    }
  }
}

function toggleFullscreen() {
  document.body.classList.toggle('fullscreen-mode');
}

function setFontSize(size) {
  document.getElementById('fontSize').value = size;
  if (selectedCell && styleMode) {
    selectedCell.style.fontSize = size + 'px';
  }
}

function setFontColor(color) {
  document.getElementById('fontColor').value = color;
  if (selectedCell && styleMode) {
    selectedCell.style.color = color;
  }
}

function toggleNumberMode() {
  numberMode = true;
  mergeMode = false;
  alignMode = false;
  styleMode = false;
  clearSelection();
  const numberPanel = document.getElementById('numberPanel');
  numberPanel.style.display = 'block';
  document.getElementById('alignPanel').style.display = 'none';
  document.getElementById('stylePanel').style.display = 'none';
  showModeMessage('ìˆ«ì ì…ë ¥ ëª¨ë“œ í™œì„±í™”\nì·¨ì†Œ ë²„íŠ¼ì„ ëˆ„ë¥¼ ë•Œê¹Œì§€ ê³„ì†í•´ì„œ ì…€ì„ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
  initNumberPanelDrag();
}

function cancelNumberMode() {
  numberMode = false;
  clearSelection();
  const numberPanel = document.getElementById('numberPanel');
  numberPanel.style.display = 'none';
  numberPanel.style.transform = 'translate(0, 0)';
}

function initNumberPanelDrag() {
  const numberPanel = document.getElementById('numberPanel');
  const title = numberPanel.querySelector('.title');
  let isDragging = false;
  let currentX;
  let currentY;
  let initialX;
  let initialY;
  let xOffset = 0;
  let yOffset = 0;

  title.addEventListener('mousedown', dragStart);
  document.addEventListener('mousemove', drag);
  document.addEventListener('mouseup', dragEnd);

  function dragStart(e) {
    initialX = e.clientX - xOffset;
    initialY = e.clientY - yOffset;
    if (e.target === title) {
      isDragging = true;
    }
  }

  function drag(e) {
    if (isDragging) {
      e.preventDefault();
      currentX = e.clientX - initialX;
      currentY = e.clientY - initialY;
      xOffset = currentX;
      yOffset = currentY;
      setTranslate(currentX, currentY, numberPanel);
    }
  }

  function dragEnd(e) {
    initialX = currentX;
    initialY = currentY;
    isDragging = false;
  }

  function setTranslate(xPos, yPos, el) {
    el.style.transform = `translate(${xPos}px, ${yPos}px)`;
  }
}

function setUnit(unit) {
  document.getElementById('unitSuffix').value = unit;
}

function updateMultiInput() {
  const selected = Array.from(document.querySelectorAll('.selected'));
  const multiInput = document.getElementById('multiInput');
  const cellInputs = document.getElementById('cellInputs');
  
  if (selected.length > 1) {
    multiInput.classList.add('active');
    cellInputs.innerHTML = '';
    
    selected.forEach((cell, index) => {
      const cellInput = document.createElement('div');
      cellInput.className = 'cell-input';
      cellInput.innerHTML = `
        <label>ì…€ ${index + 1}</label>
        <input type="number" 
               data-cell-index="${index}" 
               value="${cell.textContent || ''}" 
               onchange="updateCellValue(this)">
      `;
      cellInputs.appendChild(cellInput);
    });
  } else {
    multiInput.classList.remove('active');
  }
}

function applyNumberFormat() {
  if (!numberMode) return alert('ìˆ«ì ì…ë ¥ ëª¨ë“œë¥¼ í™œì„±í™”í•˜ì„¸ìš”.');
  const selected = Array.from(document.querySelectorAll('.selected'));
  if (selected.length === 0) return alert('ìˆ«ì í˜•ì‹ì„ ì ìš©í•  ì…€ì„ ì„ íƒí•˜ì„¸ìš”.');
  
  const format = document.getElementById('numberFormat').value;
  const unitType = document.getElementById('unitType').value;
  const prefix = document.getElementById('unitPrefix').value;
  const suffix = document.getElementById('unitSuffix').value;
  const minValue = document.getElementById('minValue').value;
  const maxValue = document.getElementById('maxValue').value;
  
  // ì„ íƒëœ ì…€ë“¤ì˜ ì—´ ì¸ë±ìŠ¤ ì¶”ì¶œ
  const selectedColumns = new Set(selected.map(cell => cell.cellIndex));
  
  selected.forEach(cell => {
    // í˜„ì¬ ì…€ì˜ ê°’ì„ ê°€ì ¸ì˜´
    let currentValue = cell.textContent.trim();
    
    // ìˆ«ìê°€ ì•„ë‹Œ ë¬¸ì ì œê±° (ë‹¨ìœ„ ë“±)
    currentValue = currentValue.replace(/[^0-9.-]/g, '');
    
    // ìˆ«ìë¡œ ë³€í™˜
    let numValue = parseFloat(currentValue);
    if (isNaN(numValue)) {
      numValue = 0;
    }
    
    // ë²”ìœ„ ì²´í¬
    if (minValue && numValue < parseFloat(minValue)) {
      numValue = parseFloat(minValue);
    }
    if (maxValue && numValue > parseFloat(maxValue)) {
      numValue = parseFloat(maxValue);
    }
    
    // í˜•ì‹ ì ìš©
    cell.textContent = formatNumber(numValue, format, unitType, prefix, suffix);
    
    // ë°ì´í„° ì†ì„± ì €ì¥
    cell.setAttribute('data-number-format', format);
    cell.setAttribute('data-unit-type', unitType);
    cell.setAttribute('data-unit-prefix', prefix);
    cell.setAttribute('data-unit-suffix', suffix);
    cell.setAttribute('data-min-value', minValue);
    cell.setAttribute('data-max-value', maxValue);
    
    // ì¢Œì¸¡ ì •ë ¬ ì ìš©
    cell.style.textAlign = 'left';
  });
  
  // ì„ íƒëœ ì—´ì˜ ìë™ ì—´í­ ì¡°ì •
  adjustColumnWidths(selectedColumns);
  
  numberMode = false;
  clearSelection();
  document.getElementById('numberPanel').style.display = 'none';
}

function adjustColumnWidths(selectedColumns) {
  const table = document.getElementById('editableTable');
  const rows = table.rows;
  
  // ê° ì„ íƒëœ ì—´ì— ëŒ€í•´
  selectedColumns.forEach(colIndex => {
    let maxWidth = 0;
    const padding = 20; // ì…€ íŒ¨ë”© ê³ ë ¤
    
    // í•´ë‹¹ ì—´ì˜ ëª¨ë“  ì…€ì„ ê²€ì‚¬í•˜ì—¬ ìµœëŒ€ ë„ˆë¹„ ê³„ì‚°
    for (let i = 0; i < rows.length; i++) {
      const cell = rows[i].cells[colIndex];
      if (cell) {
        // ì„ì‹œ span ìš”ì†Œë¥¼ ìƒì„±í•˜ì—¬ ì‹¤ì œ í…ìŠ¤íŠ¸ ë„ˆë¹„ ì¸¡ì •
        const span = document.createElement('span');
        span.style.visibility = 'hidden';
        span.style.position = 'absolute';
        span.style.whiteSpace = 'nowrap';
        span.style.font = window.getComputedStyle(cell).font;
        span.textContent = cell.textContent;
        document.body.appendChild(span);
        
        const width = span.offsetWidth + padding;
        maxWidth = Math.max(maxWidth, width);
        
        document.body.removeChild(span);
      }
    }
    
    // ìµœì†Œ ë„ˆë¹„ ì„¤ì • (ìµœì†Œ 100px)
    maxWidth = Math.max(maxWidth, 100);
    
    // í•´ë‹¹ ì—´ì˜ ëª¨ë“  ì…€ì— ë„ˆë¹„ ì ìš©
    for (let i = 0; i < rows.length; i++) {
      const cell = rows[i].cells[colIndex];
      if (cell) {
        cell.style.width = maxWidth + 'px';
        cell.style.minWidth = maxWidth + 'px';
      }
    }
  });
}

// ìˆ«ì ì…ë ¥ í•„ë“œì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
document.getElementById('numberFormat').addEventListener('change', function() {
  const selected = Array.from(document.querySelectorAll('.selected'));
  if (selected.length > 0) {
    const format = this.value;
    const unitType = document.getElementById('unitType').value;
    const prefix = document.getElementById('unitPrefix').value;
    const suffix = document.getElementById('unitSuffix').value;
    
    selected.forEach(cell => {
      let currentValue = cell.textContent.trim().replace(/[^0-9.-]/g, '');
      let numValue = parseFloat(currentValue);
      if (!isNaN(numValue)) {
        cell.textContent = formatNumber(numValue, format, unitType, prefix, suffix);
        cell.style.textAlign = 'left';
      }
    });
  }
});

document.getElementById('unitType').addEventListener('change', function() {
  const selected = Array.from(document.querySelectorAll('.selected'));
  if (selected.length > 0) {
    const format = document.getElementById('numberFormat').value;
    const unitType = this.value;
    const prefix = document.getElementById('unitPrefix').value;
    const suffix = document.getElementById('unitSuffix').value;
    
    selected.forEach(cell => {
      let currentValue = cell.textContent.trim().replace(/[^0-9.-]/g, '');
      let numValue = parseFloat(currentValue);
      if (!isNaN(numValue)) {
        cell.textContent = formatNumber(numValue, format, unitType, prefix, suffix);
        cell.style.textAlign = 'left';
      }
    });
  }
});

document.getElementById('unitPrefix').addEventListener('input', function() {
  const selected = Array.from(document.querySelectorAll('.selected'));
  if (selected.length > 0) {
    const format = document.getElementById('numberFormat').value;
    const unitType = document.getElementById('unitType').value;
    const prefix = this.value;
    const suffix = document.getElementById('unitSuffix').value;
    
    selected.forEach(cell => {
      let currentValue = cell.textContent.trim().replace(/[^0-9.-]/g, '');
      let numValue = parseFloat(currentValue);
      if (!isNaN(numValue)) {
        cell.textContent = formatNumber(numValue, format, unitType, prefix, suffix);
        cell.style.textAlign = 'left';
      }
    });
  }
});

document.getElementById('unitSuffix').addEventListener('input', function() {
  const selected = Array.from(document.querySelectorAll('.selected'));
  if (selected.length > 0) {
    const format = document.getElementById('numberFormat').value;
    const unitType = document.getElementById('unitType').value;
    const prefix = document.getElementById('unitPrefix').value;
    const suffix = this.value;
    
    selected.forEach(cell => {
      let currentValue = cell.textContent.trim().replace(/[^0-9.-]/g, '');
      let numValue = parseFloat(currentValue);
      if (!isNaN(numValue)) {
        cell.textContent = formatNumber(numValue, format, unitType, prefix, suffix);
        cell.style.textAlign = 'left';
      }
    });
  }
});

function updateCellValue(input) {
  const selected = Array.from(document.querySelectorAll('.selected'));
  const index = parseInt(input.dataset.cellIndex);
  if (selected[index]) {
    const format = document.getElementById('numberFormat').value;
    const unitType = document.getElementById('unitType').value;
    const prefix = document.getElementById('unitPrefix').value;
    const suffix = document.getElementById('unitSuffix').value;
    
    selected[index].textContent = formatNumber(input.value, format, unitType, prefix, suffix);
  }
}

function applySameValue() {
  const value = prompt('ëª¨ë“  ì…€ì— ì ìš©í•  ê°’ì„ ì…ë ¥í•˜ì„¸ìš”:');
  if (value === null) return;
  
  const format = document.getElementById('numberFormat').value;
  const unitType = document.getElementById('unitType').value;
  const prefix = document.getElementById('unitPrefix').value;
  const suffix = document.getElementById('unitSuffix').value;
  
  const selected = Array.from(document.querySelectorAll('.selected'));
  selected.forEach(cell => {
    cell.textContent = formatNumber(value, format, unitType, prefix, suffix);
  });
  updateMultiInput();
}

function applySequence() {
  const start = parseInt(prompt('ì‹œì‘ ê°’ì„ ì…ë ¥í•˜ì„¸ìš”:'));
  if (isNaN(start)) return;
  
  const step = parseInt(prompt('ì¦ê°€ ê°’ì„ ì…ë ¥í•˜ì„¸ìš”:'));
  if (isNaN(step)) return;
  
  const format = document.getElementById('numberFormat').value;
  const unitType = document.getElementById('unitType').value;
  const prefix = document.getElementById('unitPrefix').value;
  const suffix = document.getElementById('unitSuffix').value;
  
  const selected = Array.from(document.querySelectorAll('.selected'));
  selected.forEach((cell, index) => {
    const value = start + (index * step);
    cell.textContent = formatNumber(value, format, unitType, prefix, suffix);
  });
  updateMultiInput();
}

function applyRandom() {
  const min = parseInt(prompt('ìµœì†Œ ê°’ì„ ì…ë ¥í•˜ì„¸ìš”:'));
  if (isNaN(min)) return;
  
  const max = parseInt(prompt('ìµœëŒ€ ê°’ì„ ì…ë ¥í•˜ì„¸ìš”:'));
  if (isNaN(max)) return;
  
  const format = document.getElementById('numberFormat').value;
  const unitType = document.getElementById('unitType').value;
  const prefix = document.getElementById('unitPrefix').value;
  const suffix = document.getElementById('unitSuffix').value;
  
  const selected = Array.from(document.querySelectorAll('.selected'));
  selected.forEach(cell => {
    const value = Math.floor(Math.random() * (max - min + 1)) + min;
    cell.textContent = formatNumber(value, format, unitType, prefix, suffix);
  });
  updateMultiInput();
}

for (let i = 0; i < 10; i++) addRow();
initSelectable();  // âœ… ì…€ ì„ íƒ ì´ë²¤íŠ¸ í™œì„±í™”ë¥¼ ìœ„í•œ í˜¸ì¶œ ì¶”ê°€
</script>

</body>
</html>